package com.revworkforce.service;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.revworkforce.dao.LeaveAdminDAO;

public class LeaveAdminService {

    private static final Logger logger =
            LoggerFactory.getLogger(LeaveAdminService.class);

    private LeaveAdminDAO dao;

    // ðŸ”¹ Default constructor (for normal execution)
    public LeaveAdminService() {
        this.dao = new LeaveAdminDAO();
        logger.info("LeaveAdminService initialized using default constructor");
    }

    // ðŸ”¹ Constructor for Unit Testing (Mockito)
    public LeaveAdminService(LeaveAdminDAO dao) {
        this.dao = dao;
        logger.info("LeaveAdminService initialized using injected LeaveAdminDAO");
    }

    public void addLeaveType(String name, int quota) throws Exception {
        logger.info("Add leave type request: name={}, quota={}", name, quota);
        try {
            dao.addLeaveType(name, quota);
            logger.info("Leave type added successfully: name={}", name);
        } catch (Exception e) {
            logger.error("Failed to add leave type: name={}", name, e);
            throw e;
        }
    }

    public void assignLeaveQuota(int empId, int typeId, int days) throws Exception {
        logger.info("Assign leave quota: empId={}, typeId={}, days={}",
                empId, typeId, days);
        try {
            dao.assignLeaveQuota(empId, typeId, days);
            logger.info("Leave quota assigned successfully for empId={}", empId);
        } catch (Exception e) {
            logger.error("Failed to assign leave quota for empId={}", empId, e);
            throw e;
        }
    }

    public void adjustLeaveBalance(int empId, int typeId, int balance) throws Exception {
        logger.info("Adjust leave balance: empId={}, typeId={}, balance={}",
                empId, typeId, balance);
        try {
            dao.adjustLeaveBalance(empId, typeId, balance);
            logger.info("Leave balance adjusted successfully for empId={}", empId);
        } catch (Exception e) {
            logger.error("Failed to adjust leave balance for empId={}", empId, e);
            throw e;
        }
    }
}
