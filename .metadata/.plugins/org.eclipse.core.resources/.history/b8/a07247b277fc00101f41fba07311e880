package com.revworkforce.service;

import com.revworkforce.dao.EmployeeDAO;
import com.revworkforce.model.Employee;

public class EmployeeService {

    private EmployeeDAO dao = new EmployeeDAO();

    // ================= LOGIN =================
    public Employee login(int empId, String password) throws Exception {

        if (password == null || password.trim().isEmpty()) {
            throw new Exception("Password cannot be empty");
        }

        Employee emp = dao.login(empId, password);

        if (emp == null) {
            throw new Exception("Invalid Employee ID or Password");
        }

        if (!"ACTIVE".equalsIgnoreCase(emp.getStatus())) {
            throw new Exception("Employee account is inactive");
        }

        return emp;
    }

    // ================= CHANGE PASSWORD =================
    public void changePassword(int empId,
                               String newPwd,
                               String confirmPwd) throws Exception {

        if (newPwd == null || confirmPwd == null) {
            throw new Exception("Password cannot be null");
        }

        if (!newPwd.equals(confirmPwd)) {
            throw new Exception("Passwords do not match");
        }

        PasswordValidator.validate(newPwd);

        dao.updatePassword(empId, newPwd);
    }

    // ================= ADD EMPLOYEE (ADMIN) =================
    public void addEmployee(String name,
                            String email,
                            String tempPwd) throws Exception {

        if (name == null || name.trim().isEmpty()) {
            throw new Exception("Employee name is required");
        }

        if (email == null || email.trim().isEmpty()) {
            throw new Exception("Email is required");
        }

        if (tempPwd == null || tempPwd.length() < 6) {
            throw new Exception("Temporary password must be at least 6 characters");
        }

        dao.addEmployee(name, email, tempPwd);
    }
}
