package com.revworkforce.service;

import java.sql.Date;
import com.revworkforce.dao.PerformanceDAO;

public class PerformanceService {

    private PerformanceDAO dao = new PerformanceDAO();

    public void submitReview(int empId,
                             int year,
                             String del,
                             String ach,
                             String imp,
                             int rating) throws Exception {

        dao.createReview(empId, year, del, ach, imp, rating);
        System.out.println("Performance review created");
    }

    public void createGoal(int empId,
                           String desc,
                           Date deadline,
                           String priority,
                           String metrics) throws Exception {

        int reviewId = dao.getLatestReviewId(empId);
        dao.createGoal(reviewId, desc, deadline, priority, metrics);
        System.out.println("Goal added successfully");
    }

    public void viewMyGoals(int empId) throws Exception {
        dao.viewMyGoals(empId);
    }

    public void updateGoalProgress(int goalId, int progress) throws Exception {
        dao.updateGoalProgress(goalId, progress);
        System.out.println("Goal progress updated");
    }

    public void viewManagerFeedback(int empId) throws Exception {
        dao.viewManagerFeedback(empId);
    }
 // ================= MANAGER =================
    public void viewTeamGoals(int managerId) throws Exception {
        dao.viewTeamGoals(managerId);
    }

    public void approveGoal(int goalId) throws Exception {
        dao.approveOrRejectGoal(goalId, "APPROVED");
        System.out.println("Goal approved");
    }

    public void rejectGoal(int goalId) throws Exception {
        dao.approveOrRejectGoal(goalId, "REJECTED");
        System.out.println("Goal rejected");
    }

    // ================= EMPLOYEE =================
    @Override
    public void updateGoalProgress(int goalId, int progress) throws Exception {

        dao.updateGoalProgress(goalId, progress);

        if (progress == 100) {
            dao.notifyGoalCompletion(goalId);
        }

        System.out.println("Goal progress updated");
    }

}
