package com.revworkforce.service;

import java.sql.ResultSet;

import com.revworkforce.dao.PerformanceDAO;

public class PerformanceService {

    private PerformanceDAO dao = new PerformanceDAO();

    public void submitReview(int empId,
                             int year,
                             String deliverables,
                             String accomplishments,
                             String improvements,
                             int rating) throws Exception {

        if (rating < 1 || rating > 5) {
            throw new Exception("Rating must be between 1 and 5");
        }

        dao.createReview(
            empId, year, deliverables,
            accomplishments, improvements, rating
        );

        System.out.println("Performance review submitted successfully");
    }

    public void viewMyReviews(int empId) throws Exception {

        ResultSet rs = dao.getMyReviews(empId);
        boolean found = false;

        System.out.println("\n--- My Performance Reviews ---");

        while (rs.next()) {
            found = true;
            System.out.println(
                rs.getInt("REVIEW_YEAR") + " | " +
                "Rating: " + rs.getInt("SELF_RATING") + " | " +
                rs.getString("STATUS")
            );

            String feedback = rs.getString("MANAGER_FEEDBACK");
            if (feedback != null) {
                System.out.println("Feedback: " + feedback);
            }
        }

        if (!found) {
            System.out.println("No performance reviews found");
        }
    }
}
