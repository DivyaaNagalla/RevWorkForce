package com.revworkforce.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import com.revworkforce.util.DBUtil;

public class NotificationDAO {

    public int getUnreadCount(int empId) throws Exception {

        String sql =
            "SELECT COUNT(*) FROM NOTIFICATION " +
            "WHERE EMP_ID=? AND IS_READ='N'";

        PreparedStatement ps =
            DBUtil.getConnection().prepareStatement(sql);

        ps.setInt(1, empId);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1);
    }
}
